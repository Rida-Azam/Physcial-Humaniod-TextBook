---
id: chapter5
sidebar_position: 5
---

# URDF & Robot Description Mastery

## Overview

Unified Robot Description Format (URDF) is the standard XML-based format for representing robot models in ROS. This chapter provides comprehensive coverage of URDF for humanoid robotics, including advanced kinematic chains, dynamic properties, and visualization techniques.

## Learning Objectives

By the end of this chapter, you will be able to:
- Create complex URDF models for humanoid robots
- Define proper kinematic chains and joint constraints
- Specify dynamic properties for accurate simulation
- Visualize and debug URDF models
- Integrate URDF with ROS 2 tools and simulation environments

## URDF Fundamentals

URDF (Unified Robot Description Format) is an XML format that describes robots in terms of their links, joints, and other elements. For humanoid robots, URDF becomes particularly complex due to the articulated structure with multiple degrees of freedom.

### Basic URDF Structure

A humanoid URDF typically includes:
- **Links**: Rigid bodies with visual, collision, and inertial properties
- **Joints**: Connections between links with specific degrees of freedom
- **Materials**: Visual appearance definitions
- **Gazebo plugins**: Simulation-specific properties

### Example: Basic Humanoid Link Definition

```xml
<link name="torso">
  <visual>
    <geometry>
      <capsule length="0.3" radius="0.15"/>
    </geometry>
    <material name="light_grey">
      <color rgba="0.7 0.7 0.7 1.0"/>
    </material>
  </visual>
  <collision>
    <geometry>
      <capsule length="0.3" radius="0.15"/>
    </geometry>
  </collision>
  <inertial>
    <mass value="10.0"/>
    <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.1"/>
  </inertial>
</link>
```

## Advanced Humanoid Joint Definitions

Humanoid robots require sophisticated joint definitions to model natural movement patterns:

### Revolute Joints for Limbs

```xml
<joint name="left_hip_yaw" type="revolute">
  <parent link="torso"/>
  <child link="left_thigh"/>
  <origin xyz="0.0 -0.1 -0.1" rpy="0 0 0"/>
  <axis xyz="0 0 1"/>
  <limit lower="-1.0" upper="1.0" effort="100.0" velocity="3.0"/>
  <dynamics damping="1.0" friction="0.1"/>
</joint>
```

### Continuous Joints for Free Rotation

For joints that can rotate continuously, such as some shoulder joints:

```xml
<joint name="right_shoulder_roll" type="continuous">
  <parent link="torso"/>
  <child link="right_upper_arm"/>
  <origin xyz="0.0 0.2 0.1" rpy="0 0 0"/>
  <axis xyz="1 0 0"/>
  <dynamics damping="0.5"/>
</joint>
```

## Kinematic Chain Design for Humanoids

Humanoid robots have complex kinematic structures that require careful planning:

### Leg Chain Example
```
torso
├── left_hip_yaw
    ├── left_thigh
    ├── left_knee
        ├── left_shin
        ├── left_ankle
            └── left_foot
```

### Arm Chain Example
```
torso
├── left_shoulder_pitch
    ├── left_upper_arm
    ├── left_elbow
        └── left_forearm
            └── left_hand
```

## Dynamic Properties and Simulation

Accurate dynamic properties are crucial for realistic humanoid simulation:

### Inertial Calculations

For complex humanoid links, proper inertial properties are essential:
- Mass distribution affects balance and movement
- Moment of inertia tensors determine rotational dynamics
- Center of mass affects stability

### Center of Mass Estimation

For humanoid body parts, common approximations:
- Torso: Box or capsule with mass concentrated in center
- Limbs: Capsules with uniform mass distribution
- Head: Sphere with appropriate mass

## Advanced URDF Features

### Transmission Elements

To interface with ROS 2 controllers:

```xml
<transmission name="left_hip_yaw_trans">
  <type>transmission_interface/SimpleTransmission</type>
  <joint name="left_hip_yaw">
    <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
  </joint>
  <actuator name="left_hip_yaw_motor">
    <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
    <mechanicalReduction>1</mechanicalReduction>
  </actuator>
</transmission>
```

### Gazebo Integration

Special tags for simulation-specific properties:

```xml
<gazebo reference="left_foot">
  <mu1>0.8</mu1>
  <mu2>0.8</mu2>
  <kp>1000000.0</kp>
  <kd>100.0</kd>
  <material>Gazebo/Grey</material>
</gazebo>
```

## URDF Best Practices for Humanoids

1. **Consistent Naming**: Use systematic naming conventions (e.g., `left_hip_yaw`, `right_knee_pitch`)
2. **Proper Scaling**: Ensure all dimensions are in meters and masses in kg
3. **Realistic Joints**: Set appropriate limits based on human anatomy or robot specifications
4. **Collision Avoidance**: Design joint limits to prevent self-collision
5. **Mass Distribution**: Verify total robot mass is realistic

## Visualization and Debugging

### Checking URDF Validity

```bash
check_urdf /path/to/your/robot.urdf
```

### Visualizing with RViz

Use robot_state_publisher and joint_state_publisher to visualize your URDF model in RViz.

### Debugging Kinematic Chains

Common issues:
- Disconnected links
- Incorrect joint axes
- Missing inertial properties
- Self-penetrating geometries

## Integration with ROS 2 Ecosystem

### Robot State Publisher

The robot_state_publisher package transforms joint states to tf transforms, allowing visualization of the complete kinematic chain.

### Forward and Inverse Kinematics

URDF models work with kinematic solvers like KDL or MoveIt! for complex motion planning.

## Exercises

1. Create a simplified URDF model of a bipedal robot with 12 degrees of freedom
2. Add proper inertial properties to your humanoid model
3. Visualize your URDF in RViz and verify the kinematic chain is correct

## Project

Design a complete humanoid URDF model with at least 20 joints, including proper visual, collision, and inertial properties. Validate the model using URDF checking tools and visualize it in RViz.